<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title id="head-title">testResults.html</title>
      <link href="assets\style.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <h1 id="title">testResults.html</h1>
    <p>Report generated on 04-Dec-2025 at 08:31:43 by <a href="https://pypi.python.org/pypi/pytest-html">pytest-html</a>
        v4.1.1</p>
    <div id="environment-header">
      <h2>Environment</h2>
    </div>
    <table id="environment"></table>
    <!-- TEMPLATES -->
      <template id="template_environment_row">
      <tr>
        <td></td>
        <td></td>
      </tr>
    </template>
    <template id="template_results-table__body--empty">
      <tbody class="results-table-row">
        <tr id="not-found-message">
          <td colspan="4">No results found. Check the filters.</th>
        </tr>
    </template>
    <template id="template_results-table__tbody">
      <tbody class="results-table-row">
        <tr class="collapsible">
        </tr>
        <tr class="extras-row">
          <td class="extra" colspan="4">
            <div class="extraHTML"></div>
            <div class="media">
              <div class="media-container">
                  <div class="media-container__nav--left"><</div>
                  <div class="media-container__viewport">
                    <img src="" />
                    <video controls>
                      <source src="" type="video/mp4">
                    </video>
                  </div>
                  <div class="media-container__nav--right">></div>
                </div>
                <div class="media__name"></div>
                <div class="media__counter"></div>
            </div>
            <div class="logwrapper">
              <div class="logexpander"></div>
              <div class="log"></div>
            </div>
          </td>
        </tr>
      </tbody>
    </template>
    <!-- END TEMPLATES -->
    <div class="summary">
      <div class="summary__data">
        <h2>Summary</h2>
        <div class="additional-summary prefix">
        </div>
        <p class="run-count">18 tests took 00:00:27.</p>
        <p class="filter">(Un)check the boxes to filter the results.</p>
        <div class="summary__reload">
          <div class="summary__reload__button hidden" onclick="location.reload()">
            <div>There are still tests running. <br />Reload this page to get the latest results!</div>
          </div>
        </div>
        <div class="summary__spacer"></div>
        <div class="controls">
          <div class="filters">
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="failed" />
            <span class="failed">1 Failed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="passed" />
            <span class="passed">17 Passed,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="skipped" />
            <span class="skipped">3 Skipped,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xfailed" disabled/>
            <span class="xfailed">0 Expected failures,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="xpassed" disabled/>
            <span class="xpassed">0 Unexpected passes,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="error" disabled/>
            <span class="error">0 Errors,</span>
            <input checked="true" class="filter" name="filter_checkbox" type="checkbox" data-test-result="rerun" />
            <span class="rerun">2 Reruns</span>
          </div>
          <div class="collapse">
            <button id="show_all_details">Show all details</button>&nbsp;/&nbsp;<button id="hide_all_details">Hide all details</button>
          </div>
        </div>
      </div>
      <div class="additional-summary summary">
      </div>
      <div class="additional-summary postfix">
      </div>
    </div>
    <table id="results-table">
      <thead id="results-table-head">
        <tr>
          <th class="sortable" data-column-type="result">Result</th>
          <th class="sortable" data-column-type="testId">Test</th>
          <th class="sortable" data-column-type="duration">Duration</th>
          <th>Links</th>
        </tr>
      </thead>
    </table>
  </body>
  <footer>
    <div id="data-container" data-jsonblob="{&#34;environment&#34;: {&#34;Python&#34;: &#34;3.10.1&#34;, &#34;Platform&#34;: &#34;Windows-10-10.0.26100-SP0&#34;, &#34;Packages&#34;: {&#34;pytest&#34;: &#34;8.3.4&#34;, &#34;pluggy&#34;: &#34;1.5.0&#34;}, &#34;Plugins&#34;: {&#34;anyio&#34;: &#34;4.9.0&#34;, &#34;Faker&#34;: &#34;37.4.0&#34;, &#34;ast-transformer&#34;: &#34;1.0.3&#34;, &#34;check&#34;: &#34;2.6.0&#34;, &#34;html&#34;: &#34;4.1.1&#34;, &#34;metadata&#34;: &#34;3.1.1&#34;, &#34;order&#34;: &#34;1.3.0&#34;, &#34;ordering&#34;: &#34;0.6&#34;, &#34;rerunfailures&#34;: &#34;15.1&#34;, &#34;soft-assertions&#34;: &#34;0.1.2&#34;, &#34;xdist&#34;: &#34;3.7.0&#34;}, &#34;JAVA_HOME&#34;: &#34;C:\\Users\\hetur\\.jdks\\openjdk-21.0.2&#34;}, &#34;tests&#34;: {&#34;TestScripts/test_data_quality.py::TestDataQuality::test_DQ_Sales_csv_null_values_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_quality.py::TestDataQuality::test_DQ_Sales_csv_null_values_check&#34;, &#34;duration&#34;: &#34;513 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_quality.py::TestDataQuality::test_DQ_Sales_csv_null_values_check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;513 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw2] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n\n------------------------------ Captured log call -------------------------------\nINFO     CommonUtilities.utilities:test_data_quality.py:54 Null check for sales_data has started...\nINFO     CommonUtilities.utilities:test_data_quality.py:56 is there a null in the file: True\nINFO     CommonUtilities.utilities:test_data_quality.py:58 Null check for sales_data has completed...\n\n&#34;}], &#34;TestScripts/test_data_extraction.py::TestDataExtraction::test_DE_from_supplier_data_between_source_and_staging&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_extraction.py::TestDataExtraction::test_DE_from_supplier_data_between_source_and_staging&#34;, &#34;duration&#34;: &#34;703 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_extraction.py::TestDataExtraction::test_DE_from_supplier_data_between_source_and_staging&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;703 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw3] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n\n------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:32 mysql database connectiuon is being established..\nINFO     conftest:conftest.py:35 mysql database connectiuon has been established.\n&#34;}], &#34;TestScripts/test_data_extraction.py::TestDataExtraction::test_DE_from_inventory_data_between_source_and_staging&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_extraction.py::TestDataExtraction::test_DE_from_inventory_data_between_source_and_staging&#34;, &#34;duration&#34;: &#34;4 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_extraction.py::TestDataExtraction::test_DE_from_inventory_data_between_source_and_staging&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;4 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw3] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:38 mysql database connection has been closed.&#34;}], &#34;TestScripts/test_data_quality.py::TestDataQuality::test_mysql_tables_exist&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_quality.py::TestDataQuality::test_mysql_tables_exist&#34;, &#34;duration&#34;: &#34;757 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_quality.py::TestDataQuality::test_mysql_tables_exist&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;757 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw1] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n\n------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:32 mysql database connectiuon is being established..\nINFO     conftest:conftest.py:35 mysql database connectiuon has been established.\n\n------------------------------ Captured log call -------------------------------\nINFO     CommonUtilities.utilities:utilities.py:161 the actual table is are : [&amp;#x27;fact_inventory&amp;#x27;, &amp;#x27;fact_sales&amp;#x27;, &amp;#x27;intermediate_aggregated_inventory_level&amp;#x27;, &amp;#x27;intermediate_filtered_sales&amp;#x27;, &amp;#x27;intermediate_high_sales&amp;#x27;, &amp;#x27;intermediate_low_sales&amp;#x27;, &amp;#x27;intermediate_monthly_sales_summary_source&amp;#x27;, &amp;#x27;intermediate_sales_with_details&amp;#x27;, &amp;#x27;inventory_levels_by_store&amp;#x27;, &amp;#x27;monthly_sales_summary&amp;#x27;, &amp;#x27;staging_inventory&amp;#x27;, &amp;#x27;staging_product&amp;#x27;, &amp;#x27;staging_sales&amp;#x27;, &amp;#x27;staging_stores&amp;#x27;, &amp;#x27;staging_supplier&amp;#x27;]\n\n&#34;}], &#34;TestScripts/test_data_quality.py::TestDataQuality::test_DQ_Sales_csv_file_availabilty&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_quality.py::TestDataQuality::test_DQ_Sales_csv_file_availabilty&#34;, &#34;duration&#34;: &#34;7 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_quality.py::TestDataQuality::test_DQ_Sales_csv_file_availabilty&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;7 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw1] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n\n------------------------------ Captured log call -------------------------------\nINFO     CommonUtilities.utilities:test_data_quality.py:67 file availability check for sales_data has started...\nINFO     CommonUtilities.utilities:test_data_quality.py:69 file availability check for sales_data has completed...\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:38 mysql database connection has been closed.&#34;}], &#34;TestScripts/test_data_loading.py::TestDataLoading::test_DL_fact_inventory&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_loading.py::TestDataLoading::test_DL_fact_inventory&#34;, &#34;duration&#34;: &#34;27 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_loading.py::TestDataLoading::test_DL_fact_inventory&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;27 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw1] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n\n------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:32 mysql database connectiuon is being established..\nINFO     conftest:conftest.py:35 mysql database connectiuon has been established.\n&#34;}], &#34;TestScripts/test_data_loading.py::TestDataLoading::test_DL_inventory_level_by_stores&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_loading.py::TestDataLoading::test_DL_inventory_level_by_stores&#34;, &#34;duration&#34;: &#34;9 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_loading.py::TestDataLoading::test_DL_inventory_level_by_stores&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;9 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw1] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:38 mysql database connection has been closed.&#34;}], &#34;TestScripts/test_data_loading.py::TestDataLoading::test_DL_Monthly_sales_summary&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_loading.py::TestDataLoading::test_DL_Monthly_sales_summary&#34;, &#34;duration&#34;: &#34;187 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_loading.py::TestDataLoading::test_DL_Monthly_sales_summary&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;187 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw3] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n\n------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:32 mysql database connectiuon is being established..\nINFO     conftest:conftest.py:35 mysql database connectiuon has been established.\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_data_loading:test_data_loading.py:24 Test case execution for monthly sales summary load has started...\nINFO     CommonUtilities.utilities:utilities.py:82 Expected data in the file is     product_id  total_sales  year  month\n0          101        427.0  2024      9\n1          101        263.5  2024     10\n2          102        419.0  2024      9\n3          102        254.0  2024     10\n4          103        346.0  2024      9\n5          103        339.0  2024     10\n6          104        398.0  2024      9\n7          104        346.0  2024     10\n8          105        294.0  2024      9\n9          105        355.0  2024     10\n10         106        220.0  2024      9\n11         106        255.0  2024     10\n12         107        268.0  2024      9\n13         107        360.0  2024     10\n14         108        330.0  2024      9\n15         108        261.0  2024     10\n16         109        436.0  2024      9\n17         109        423.5  2024     10\n18         110        646.0  2024      9\n19         110        408.0  2024     10\nINFO     CommonUtilities.utilities:utilities.py:84 Actual data in the file is     product_id  total_sales  year  month\n0          101        427.0  2024      9\n1          101        263.5  2024     10\n2          102        419.0  2024      9\n3          102        254.0  2024     10\n4          103        346.0  2024      9\n5          103        339.0  2024     10\n6          104        398.0  2024      9\n7          104        346.0  2024     10\n8          105        294.0  2024      9\n9          105        355.0  2024     10\n10         106        220.0  2024      9\n11         106        255.0  2024     10\n12         107        268.0  2024      9\n13         107        360.0  2024     10\n14         108        330.0  2024      9\n15         108        261.0  2024     10\n16         109        436.0  2024      9\n17         109        423.5  2024     10\n18         110        646.0  2024      9\n19         110        408.0  2024     10\nINFO     TestScripts.test_data_loading:test_data_loading.py:29 Test case execution for monthly sales summary load has completed...\n\n&#34;}], &#34;TestScripts/test_data_quality.py::TestDataQuality::test_DQ_Sales_csv_duplicate_check&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_quality.py::TestDataQuality::test_DQ_Sales_csv_duplicate_check&#34;, &#34;duration&#34;: &#34;30 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_quality.py::TestDataQuality::test_DQ_Sales_csv_duplicate_check&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;30 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw1] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n\n------------------------------ Captured log call -------------------------------\nINFO     CommonUtilities.utilities:test_data_quality.py:26 Duplicate check for sales_data has started...\nINFO     CommonUtilities.utilities:test_data_quality.py:30 Duplicate check for sales_data has completed ...\n\n&#34;}], &#34;TestScripts/test_data_loading.py::TestDataLoading::test_DL_fact_Sales&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_loading.py::TestDataLoading::test_DL_fact_Sales&#34;, &#34;duration&#34;: &#34;5 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_loading.py::TestDataLoading::test_DL_fact_Sales&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;5 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw3] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:38 mysql database connection has been closed.&#34;}], &#34;TestScripts/test_data_quality.py::TestDataQuality::test_duplicates_check_all_other_file_across_columns&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_quality.py::TestDataQuality::test_duplicates_check_all_other_file_across_columns&#34;, &#34;duration&#34;: &#34;5 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_quality.py::TestDataQuality::test_duplicates_check_all_other_file_across_columns&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;5 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw1] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n&#34;}], &#34;TestScripts/test_data_quality.py::TestDataQuality::test_duplicates_check_all_other_file_for_speciifc_columns&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Skipped&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_quality.py::TestDataQuality::test_duplicates_check_all_other_file_for_speciifc_columns::setup&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Skipped&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_quality.py::TestDataQuality::test_duplicates_check_all_other_file_for_speciifc_columns::setup&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw3] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n(&amp;#x27;D:\\\\Capstone_Sep2025_Weekdays_Test_Automation\\\\TestScripts\\\\test_data_quality.py&amp;#x27;, 38, &amp;#x27;Skipped: unconditional skip&amp;#x27;)\n&#34;}], &#34;TestScripts/test_data_quality.py::TestDataQuality::test_duplicates_check_all_targe_tables_across_columns&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Skipped&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_quality.py::TestDataQuality::test_duplicates_check_all_targe_tables_across_columns::setup&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Skipped&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_quality.py::TestDataQuality::test_duplicates_check_all_targe_tables_across_columns::setup&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw1] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n(&amp;#x27;D:\\\\Capstone_Sep2025_Weekdays_Test_Automation\\\\TestScripts\\\\test_data_quality.py&amp;#x27;, 42, &amp;#x27;Skipped: unconditional skip&amp;#x27;)\n&#34;}], &#34;TestScripts/test_data_quality.py::TestDataQuality::test_duplicates_check_all_targe_tables_specifci_columns&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Skipped&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_quality.py::TestDataQuality::test_duplicates_check_all_targe_tables_specifci_columns::setup&#34;, &#34;duration&#34;: &#34;1 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Skipped&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_quality.py::TestDataQuality::test_duplicates_check_all_targe_tables_specifci_columns::setup&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;1 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw3] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n(&amp;#x27;D:\\\\Capstone_Sep2025_Weekdays_Test_Automation\\\\TestScripts\\\\test_data_quality.py&amp;#x27;, 46, &amp;#x27;Skipped: unconditional skip&amp;#x27;)\n&#34;}], &#34;TestScripts/test_data_transformation.py::TestDataTransformation::test_DT_Router_High_Region__Sales&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_transformation.py::TestDataTransformation::test_DT_Router_High_Region__Sales&#34;, &#34;duration&#34;: &#34;183 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_transformation.py::TestDataTransformation::test_DT_Router_High_Region__Sales&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;183 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw3] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n\n------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:32 mysql database connectiuon is being established..\nINFO     conftest:conftest.py:35 mysql database connectiuon has been established.\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_data_transformation:test_data_transformation.py:39 Test case execution for Router_High_Region transformation has started...\nINFO     CommonUtilities.utilities:utilities.py:82 Expected data in the file is     sales_id  product_id  store_id  quantity  price   sale_date region\n0         11         101         4        15   14.0  2024-09-11   High\n1         13         103         6        10   22.0  2024-09-13   High\n2         15         105         4        12   11.0  2024-09-15   High\n3         17         107         6         3   26.0  2024-09-17   High\n4         19         109         8        11   20.0  2024-09-19   High\n5         21         101         1        14   15.5  2024-09-21   High\n6         23         103         3         7   18.0  2024-09-23   High\n7         25         105         2        12   13.5  2024-09-25   High\n8         27         107         1        10   19.0  2024-09-27   High\n9         29         109         6         9   24.0  2024-09-29   High\n10        31         101         4        13   14.5  2024-10-01   High\n11        33         103         6         8   21.0  2024-10-03   High\n12        35         105         4         7   15.0  2024-10-05   High\n13        37         107         6        12   18.0  2024-10-07   High\n14        39         109         8        10   22.0  2024-10-09   High\n15        41         101         3         5   15.0  2024-10-11   High\n16        43         103         5         9   19.0  2024-10-13   High\n17        45         105         7        10   25.0  2024-10-15   High\n18        47         107         9         6   24.0  2024-10-17   High\n19        49         109         2        11   18.5  2024-10-19   High\nINFO     CommonUtilities.utilities:utilities.py:84 Actual data in the file is     sales_id  product_id  store_id  quantity  price   sale_date region\n0         11         101         4        15   14.0  2024-09-11   High\n1         13         103         6        10   22.0  2024-09-13   High\n2         15         105         4        12   11.0  2024-09-15   High\n3         17         107         6         3   26.0  2024-09-17   High\n4         19         109         8        11   20.0  2024-09-19   High\n5         21         101         1        14   15.5  2024-09-21   High\n6         23         103         3         7   18.0  2024-09-23   High\n7         25         105         2        12   13.5  2024-09-25   High\n8         27         107         1        10   19.0  2024-09-27   High\n9         29         109         6         9   24.0  2024-09-29   High\n10        31         101         4        13   14.5  2024-10-01   High\n11        33         103         6         8   21.0  2024-10-03   High\n12        35         105         4         7   15.0  2024-10-05   High\n13        37         107         6        12   18.0  2024-10-07   High\n14        39         109         8        10   22.0  2024-10-09   High\n15        41         101         3         5   15.0  2024-10-11   High\n16        43         103         5         9   19.0  2024-10-13   High\n17        45         105         7        10   25.0  2024-10-15   High\n18        47         107         9         6   24.0  2024-10-17   High\n19        49         109         2        11   18.5  2024-10-19   High\nINFO     TestScripts.test_data_transformation:test_data_transformation.py:44 Test case execution for Router_High_Region transformation has completed...\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:38 mysql database connection has been closed.&#34;}], &#34;TestScripts/test_data_transformation.py::TestDataTransformation::test_DT_Filter_Sales&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_transformation.py::TestDataTransformation::test_DT_Filter_Sales&#34;, &#34;duration&#34;: &#34;266 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_transformation.py::TestDataTransformation::test_DT_Filter_Sales&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;266 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw1] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n\n------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:32 mysql database connectiuon is being established..\nINFO     conftest:conftest.py:35 mysql database connectiuon has been established.\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_data_transformation:test_data_transformation.py:26 Test case execution for filter transformation has started...\nINFO     CommonUtilities.utilities:utilities.py:82 Expected data in the file is     sales_id  product_id  store_id  quantity  price   sale_date region\n0         10         110         4         9   17.0  2024-09-10    Low\n1         11         101         4        15   14.0  2024-09-11   High\n2         12         102         5         9   27.0  2024-09-12    Low\n3         13         103         6        10   22.0  2024-09-13   High\n4         14         104         7         8   31.0  2024-09-14    Low\n5         15         105         4        12   11.0  2024-09-15   High\n6         16         106         5         5   23.0  2024-09-16    Low\n7         17         107         6         3   26.0  2024-09-17   High\n8         18         108         7         6   28.0  2024-09-18    Low\n9         19         109         8        11   20.0  2024-09-19   High\n10        20         110         9         9   19.5  2024-09-20    Low\n11        21         101         1        14   15.5  2024-09-21   High\n12        22         102         2         8   22.0  2024-09-22    Low\n13        23         103         3         7   18.0  2024-09-23   High\n14        24         104         4         6   25.0  2024-09-24    Low\n15        25         105         2        12   13.5  2024-09-25   High\n16        26         106         3         5   21.0  2024-09-26    Low\n17        27         107         1        10   19.0  2024-09-27   High\n18        28         108         5         6   27.0  2024-09-28    Low\n19        29         109         6         9   24.0  2024-09-29   High\n20        30         110         7         7   23.5  2024-09-30    Low\n21        31         101         4        13   14.5  2024-10-01   High\n22        32         102         5         6   29.0  2024-10-02    Low\n23        33         103         6         8   21.0  2024-10-03   High\n24        34         104         7         5   30.0  2024-10-04    Low\n25        35         105         4         7   15.0  2024-10-05   High\n26        36         106         5         3   25.0  2024-10-06    Low\n27        37         107         6        12   18.0  2024-10-07   High\n28        38         108         7         9   20.0  2024-10-08    Low\n29        39         109         8        10   22.0  2024-10-09   High\n30        40         110         9         6   26.0  2024-10-10    Low\n31        41         101         3         5   15.0  2024-10-11   High\n32        42         102         4         4   20.0  2024-10-12    Low\n33        43         103         5         9   19.0  2024-10-13   High\n34        44         104         6         7   28.0  2024-10-14    Low\n35        45         105         7        10   25.0  2024-10-15   High\n36        46         106         8         8   22.5  2024-10-16    Low\n37        47         107         9         6   24.0  2024-10-17   High\n38        48         108         1         3   27.0  2024-10-18    Low\n39        49         109         2        11   18.5  2024-10-19   High\n40        50         110         3        12   21.0  2024-10-20    Low\n41        60         110         4         9   17.0  2024-09-10    Low\nINFO     CommonUtilities.utilities:utilities.py:84 Actual data in the file is     sales_id  product_id  store_id  quantity  price   sale_date region\n0         10         110         4         9   17.0  2024-09-10    Low\n1         11         101         4        15   14.0  2024-09-11   High\n2         12         102         5         9   27.0  2024-09-12    Low\n3         13         103         6        10   22.0  2024-09-13   High\n4         14         104         7         8   31.0  2024-09-14    Low\n5         15         105         4        12   11.0  2024-09-15   High\n6         16         106         5         5   23.0  2024-09-16    Low\n7         17         107         6         3   26.0  2024-09-17   High\n8         18         108         7         6   28.0  2024-09-18    Low\n9         19         109         8        11   20.0  2024-09-19   High\n10        20         110         9         9   19.5  2024-09-20    Low\n11        21         101         1        14   15.5  2024-09-21   High\n12        22         102         2         8   22.0  2024-09-22    Low\n13        23         103         3         7   18.0  2024-09-23   High\n14        24         104         4         6   25.0  2024-09-24    Low\n15        25         105         2        12   13.5  2024-09-25   High\n16        26         106         3         5   21.0  2024-09-26    Low\n17        27         107         1        10   19.0  2024-09-27   High\n18        28         108         5         6   27.0  2024-09-28    Low\n19        29         109         6         9   24.0  2024-09-29   High\n20        30         110         7         7   23.5  2024-09-30    Low\n21        31         101         4        13   14.5  2024-10-01   High\n22        32         102         5         6   29.0  2024-10-02    Low\n23        33         103         6         8   21.0  2024-10-03   High\n24        34         104         7         5   30.0  2024-10-04    Low\n25        35         105         4         7   15.0  2024-10-05   High\n26        36         106         5         3   25.0  2024-10-06    Low\n27        37         107         6        12   18.0  2024-10-07   High\n28        38         108         7         9   20.0  2024-10-08    Low\n29        39         109         8        10   22.0  2024-10-09   High\n30        40         110         9         6   26.0  2024-10-10    Low\n31        41         101         3         5   15.0  2024-10-11   High\n32        42         102         4         4   20.0  2024-10-12    Low\n33        43         103         5         9   19.0  2024-10-13   High\n34        44         104         6         7   28.0  2024-10-14    Low\n35        45         105         7        10   25.0  2024-10-15   High\n36        46         106         8         8   22.5  2024-10-16    Low\n37        47         107         9         6   24.0  2024-10-17   High\n38        48         108         1         3   27.0  2024-10-18    Low\n39        49         109         2        11   18.5  2024-10-19   High\n40        50         110         3        12   21.0  2024-10-20    Low\n41        60         110         4         9   17.0  2024-09-10    Low\nINFO     TestScripts.test_data_transformation:test_data_transformation.py:31 Test case execution for filter transformation has completed...\n\n&#34;}], &#34;TestScripts/test_data_transformation.py::TestDataTransformation::test_DT_Router_Low_Region__Sales&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_transformation.py::TestDataTransformation::test_DT_Router_Low_Region__Sales&#34;, &#34;duration&#34;: &#34;160 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_transformation.py::TestDataTransformation::test_DT_Router_Low_Region__Sales&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;160 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw1] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_data_transformation:test_data_transformation.py:51 Test case execution for Router_Low_Region transformation has started...\nINFO     CommonUtilities.utilities:utilities.py:82 Expected data in the file is     sales_id  product_id  store_id  quantity  price   sale_date region\n0         10         110         4         9   17.0  2024-09-10    Low\n1         12         102         5         9   27.0  2024-09-12    Low\n2         14         104         7         8   31.0  2024-09-14    Low\n3         16         106         5         5   23.0  2024-09-16    Low\n4         18         108         7         6   28.0  2024-09-18    Low\n5         20         110         9         9   19.5  2024-09-20    Low\n6         22         102         2         8   22.0  2024-09-22    Low\n7         24         104         4         6   25.0  2024-09-24    Low\n8         26         106         3         5   21.0  2024-09-26    Low\n9         28         108         5         6   27.0  2024-09-28    Low\n10        30         110         7         7   23.5  2024-09-30    Low\n11        32         102         5         6   29.0  2024-10-02    Low\n12        34         104         7         5   30.0  2024-10-04    Low\n13        36         106         5         3   25.0  2024-10-06    Low\n14        38         108         7         9   20.0  2024-10-08    Low\n15        40         110         9         6   26.0  2024-10-10    Low\n16        42         102         4         4   20.0  2024-10-12    Low\n17        44         104         6         7   28.0  2024-10-14    Low\n18        46         106         8         8   22.5  2024-10-16    Low\n19        48         108         1         3   27.0  2024-10-18    Low\n20        50         110         3        12   21.0  2024-10-20    Low\n21        60         110         4         9   17.0  2024-09-10    Low\nINFO     CommonUtilities.utilities:utilities.py:84 Actual data in the file is     sales_id  product_id  store_id  quantity  price   sale_date region\n0         10         110         4         9   17.0  2024-09-10    Low\n1         12         102         5         9   27.0  2024-09-12    Low\n2         14         104         7         8   31.0  2024-09-14    Low\n3         16         106         5         5   23.0  2024-09-16    Low\n4         18         108         7         6   28.0  2024-09-18    Low\n5         20         110         9         9   19.5  2024-09-20    Low\n6         22         102         2         8   22.0  2024-09-22    Low\n7         24         104         4         6   25.0  2024-09-24    Low\n8         26         106         3         5   21.0  2024-09-26    Low\n9         28         108         5         6   27.0  2024-09-28    Low\n10        30         110         7         7   23.5  2024-09-30    Low\n11        32         102         5         6   29.0  2024-10-02    Low\n12        34         104         7         5   30.0  2024-10-04    Low\n13        36         106         5         3   25.0  2024-10-06    Low\n14        38         108         7         9   20.0  2024-10-08    Low\n15        40         110         9         6   26.0  2024-10-10    Low\n16        42         102         4         4   20.0  2024-10-12    Low\n17        44         104         6         7   28.0  2024-10-14    Low\n18        46         106         8         8   22.5  2024-10-16    Low\n19        48         108         1         3   27.0  2024-10-18    Low\n20        50         110         3        12   21.0  2024-10-20    Low\n21        60         110         4         9   17.0  2024-09-10    Low\nINFO     TestScripts.test_data_transformation:test_data_transformation.py:56 Test case execution for Router_Low_Region transformation has completed...\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:38 mysql database connection has been closed.&#34;}], &#34;TestScripts/test_data_quality.py::TestDataQuality::test_referentialIntegrity_store_id_between_Oracle_stores_and_target_mysql&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Rerun&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_quality.py::TestDataQuality::test_referentialIntegrity_store_id_between_Oracle_stores_and_target_mysql&#34;, &#34;duration&#34;: &#34;93 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Rerun&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_quality.py::TestDataQuality::test_referentialIntegrity_store_id_between_Oracle_stores_and_target_mysql&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;93 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw0] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n\nself = &amp;lt;TestScripts.test_data_quality.TestDataQuality object at 0x0000021AC62CFC40&amp;gt;\nconnect_to_oracle_database = &amp;lt;sqlalchemy.engine.base.Connection object at 0x0000021AC64A9FF0&amp;gt;\nconnect_to_mysql_database = &amp;lt;sqlalchemy.engine.base.Connection object at 0x0000021AC6315D20&amp;gt;\n\n    @pytest.mark.order(1)\n    def test_referentialIntegrity_store_id_between_Oracle_stores_and_target_mysql(self,connect_to_oracle_database,connect_to_mysql_database):\n        source_query =&amp;quot;&amp;quot;&amp;quot;select store_id from stores_bkp order by store_id&amp;quot;&amp;quot;&amp;quot;\n        target_query = &amp;quot;&amp;quot;&amp;quot;select store_id from fact_sales order by store_id&amp;quot;&amp;quot;&amp;quot;\n        df_not_matched = check_referential_integrity(\n            source_conn = connect_to_oracle_database,\n            target_conn = connect_to_mysql_database,\n            source_query = source_query,\n            target_query = target_query,\n            key_column = &amp;#x27;store_id&amp;#x27;,\n            csv_path = &amp;quot;Differences/not_matching_store_data.csv&amp;quot;\n            )\n&amp;gt;       assert df_not_matched.empty,&amp;quot;There are store_id valure in the target that do not exist in the source&amp;quot;\nE       AssertionError: There are store_id valure in the target that do not exist in the source\nE       assert False\nE        +  where False =     store_id\\n10         4\\n11         4\\n12         4\\n13         4\\n14         4\\n15         4\\n16         4\\n17         4\\n18         5\\n19         5\\n20         5\\n21         5\\n22         5\\n23         5\\n24         6\\n25         6\\n26         6\\n27         6\\n28         6\\n29         6\\n30         7\\n31         7\\n32         7\\n33         7\\n34         7\\n35         7\\n36         8\\n37         8\\n38         8\\n39         9\\n40         9\\n41         9.empty\n\nTestScripts\\test_data_quality.py:114: AssertionError\n&#34;}, {&#34;extras&#34;: [], &#34;result&#34;: &#34;Rerun&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_quality.py::TestDataQuality::test_referentialIntegrity_store_id_between_Oracle_stores_and_target_mysql&#34;, &#34;duration&#34;: &#34;93 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Rerun&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_quality.py::TestDataQuality::test_referentialIntegrity_store_id_between_Oracle_stores_and_target_mysql&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;93 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw0] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n\nself = &amp;lt;TestScripts.test_data_quality.TestDataQuality object at 0x0000021AC62CFC40&amp;gt;\nconnect_to_oracle_database = &amp;lt;sqlalchemy.engine.base.Connection object at 0x0000021AC6BD3BB0&amp;gt;\nconnect_to_mysql_database = &amp;lt;sqlalchemy.engine.base.Connection object at 0x0000021AC6315D20&amp;gt;\n\n    @pytest.mark.order(1)\n    def test_referentialIntegrity_store_id_between_Oracle_stores_and_target_mysql(self,connect_to_oracle_database,connect_to_mysql_database):\n        source_query =&amp;quot;&amp;quot;&amp;quot;select store_id from stores_bkp order by store_id&amp;quot;&amp;quot;&amp;quot;\n        target_query = &amp;quot;&amp;quot;&amp;quot;select store_id from fact_sales order by store_id&amp;quot;&amp;quot;&amp;quot;\n        df_not_matched = check_referential_integrity(\n            source_conn = connect_to_oracle_database,\n            target_conn = connect_to_mysql_database,\n            source_query = source_query,\n            target_query = target_query,\n            key_column = &amp;#x27;store_id&amp;#x27;,\n            csv_path = &amp;quot;Differences/not_matching_store_data.csv&amp;quot;\n            )\n&amp;gt;       assert df_not_matched.empty,&amp;quot;There are store_id valure in the target that do not exist in the source&amp;quot;\nE       AssertionError: There are store_id valure in the target that do not exist in the source\nE       assert False\nE        +  where False =     store_id\\n10         4\\n11         4\\n12         4\\n13         4\\n14         4\\n15         4\\n16         4\\n17         4\\n18         5\\n19         5\\n20         5\\n21         5\\n22         5\\n23         5\\n24         6\\n25         6\\n26         6\\n27         6\\n28         6\\n29         6\\n30         7\\n31         7\\n32         7\\n33         7\\n34         7\\n35         7\\n36         8\\n37         8\\n38         8\\n39         9\\n40         9\\n41         9.empty\n\nTestScripts\\test_data_quality.py:114: AssertionError\n&#34;}, {&#34;extras&#34;: [], &#34;result&#34;: &#34;Failed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_quality.py::TestDataQuality::test_referentialIntegrity_store_id_between_Oracle_stores_and_target_mysql&#34;, &#34;duration&#34;: &#34;93 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Failed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_quality.py::TestDataQuality::test_referentialIntegrity_store_id_between_Oracle_stores_and_target_mysql&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;93 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw0] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n\nself = &amp;lt;TestScripts.test_data_quality.TestDataQuality object at 0x0000021AC62CFC40&amp;gt;\nconnect_to_oracle_database = &amp;lt;sqlalchemy.engine.base.Connection object at 0x0000021AC6BFBB50&amp;gt;\nconnect_to_mysql_database = &amp;lt;sqlalchemy.engine.base.Connection object at 0x0000021AC6315D20&amp;gt;\n\n    @pytest.mark.order(1)\n    def test_referentialIntegrity_store_id_between_Oracle_stores_and_target_mysql(self,connect_to_oracle_database,connect_to_mysql_database):\n        source_query =&amp;quot;&amp;quot;&amp;quot;select store_id from stores_bkp order by store_id&amp;quot;&amp;quot;&amp;quot;\n        target_query = &amp;quot;&amp;quot;&amp;quot;select store_id from fact_sales order by store_id&amp;quot;&amp;quot;&amp;quot;\n        df_not_matched = check_referential_integrity(\n            source_conn = connect_to_oracle_database,\n            target_conn = connect_to_mysql_database,\n            source_query = source_query,\n            target_query = target_query,\n            key_column = &amp;#x27;store_id&amp;#x27;,\n            csv_path = &amp;quot;Differences/not_matching_store_data.csv&amp;quot;\n            )\n&amp;gt;       assert df_not_matched.empty,&amp;quot;There are store_id valure in the target that do not exist in the source&amp;quot;\nE       AssertionError: There are store_id valure in the target that do not exist in the source\nE       assert False\nE        +  where False =     store_id\\n10         4\\n11         4\\n12         4\\n13         4\\n14         4\\n15         4\\n16         4\\n17         4\\n18         5\\n19         5\\n20         5\\n21         5\\n22         5\\n23         5\\n24         6\\n25         6\\n26         6\\n27         6\\n28         6\\n29         6\\n30         7\\n31         7\\n32         7\\n33         7\\n34         7\\n35         7\\n36         8\\n37         8\\n38         8\\n39         9\\n40         9\\n41         9.empty\n\nTestScripts\\test_data_quality.py:114: AssertionError\n\n------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:32 mysql database connectiuon is being established..\nINFO     conftest:conftest.py:35 mysql database connectiuon has been established.\nINFO     conftest:conftest.py:22 Oracle database connectiuon is being established..\nINFO     conftest:conftest.py:25 Oracle database connectiuon has been established.\n\n------------------------------ Captured log call -------------------------------\nINFO     CommonUtilities.utilities:utilities.py:196 Running source query: select store_id from stores_bkp order by store_id\nINFO     CommonUtilities.utilities:utilities.py:198 Running target query: select store_id from fact_sales order by store_id\nINFO     CommonUtilities.utilities:utilities.py:200 Comparing key column: store_id\n\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:28 Oracle database connection has been closed.\n\n------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:22 Oracle database connectiuon is being established..\nINFO     conftest:conftest.py:25 Oracle database connectiuon has been established.\n\n------------------------------ Captured log call -------------------------------\nINFO     CommonUtilities.utilities:utilities.py:196 Running source query: select store_id from stores_bkp order by store_id\nINFO     CommonUtilities.utilities:utilities.py:198 Running target query: select store_id from fact_sales order by store_id\nINFO     CommonUtilities.utilities:utilities.py:200 Comparing key column: store_id\n\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:28 Oracle database connection has been closed.\n\n------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:22 Oracle database connectiuon is being established..\nINFO     conftest:conftest.py:25 Oracle database connectiuon has been established.\n\n------------------------------ Captured log call -------------------------------\nINFO     CommonUtilities.utilities:utilities.py:196 Running source query: select store_id from stores_bkp order by store_id\nINFO     CommonUtilities.utilities:utilities.py:198 Running target query: select store_id from fact_sales order by store_id\nINFO     CommonUtilities.utilities:utilities.py:200 Comparing key column: store_id\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:28 Oracle database connection has been closed.\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:28 Oracle database connection has been closed.\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:28 Oracle database connection has been closed.&#34;}], &#34;TestScripts/test_data_quality.py::TestDataQuality::test_referentialIntegrity_product_id_between_staging_and_target&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_quality.py::TestDataQuality::test_referentialIntegrity_product_id_between_staging_and_target&#34;, &#34;duration&#34;: &#34;16 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_quality.py::TestDataQuality::test_referentialIntegrity_product_id_between_staging_and_target&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;16 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw0] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n\n------------------------------ Captured log call -------------------------------\nINFO     CommonUtilities.utilities:utilities.py:196 Running source query: select product_id from staging_product order by product_id\nINFO     CommonUtilities.utilities:utilities.py:198 Running target query: select product_id from fact_sales order by product_id\nINFO     CommonUtilities.utilities:utilities.py:200 Comparing key column: product_id\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:38 mysql database connection has been closed.&#34;}], &#34;TestScripts/test_data_extraction.py::TestDataExtraction::test_DE_from_sales_data_between_source_and_staging&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_extraction.py::TestDataExtraction::test_DE_from_sales_data_between_source_and_staging&#34;, &#34;duration&#34;: &#34;00:00:21&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_extraction.py::TestDataExtraction::test_DE_from_sales_data_between_source_and_staging&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;00:00:21&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw2] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n\n------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:32 mysql database connectiuon is being established..\nINFO     conftest:conftest.py:35 mysql database connectiuon has been established.\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_data_extraction:test_data_extraction.py:28 Test case &amp;#x27;test_DE_from_sales_data_between_source_and_staging&amp;#x27; execution has started...\nINFO     CommonUtilities.utilities:utilities.py:27 Sales file from Linux server doenload started...\nERROR    CommonUtilities.utilities:utilities.py:37 Error while donloading the sales file from Linux server.\nINFO     CommonUtilities.utilities:utilities.py:51 Expected data in the file is     sales_id  product_id  store_id  quantity  price   sale_date region\n0          1         101         1        10   15.0  2024-09-01   High\n1          2         102         1         5   25.0  2024-09-01    Low\n2          3         103         2         7   20.0  2024-09-02   High\n3          4         104         2         3   30.0  2024-09-03    Low\n4          5         105         1        12   12.0  2024-09-05   High\n5          6         106         3         8   18.0  2024-09-06    Low\n6          7         107         1         4   22.0  2024-09-07   High\n7          8         108         2         6   24.0  2024-09-08    Low\n8          9         109         3        11   19.0  2024-09-09   High\n9         10         110         4         9   17.0  2024-09-10    Low\n10        11         101         4        15   14.0  2024-09-11   High\n11        12         102         5         9   27.0  2024-09-12    Low\n12        13         103         6        10   22.0  2024-09-13   High\n13        14         104         7         8   31.0  2024-09-14    Low\n14        15         105         4        12   11.0  2024-09-15   High\n15        16         106         5         5   23.0  2024-09-16    Low\n16        17         107         6         3   26.0  2024-09-17   High\n17        18         108         7         6   28.0  2024-09-18    Low\n18        19         109         8        11   20.0  2024-09-19   High\n19        20         110         9         9   19.5  2024-09-20    Low\n20        21         101         1        14   15.5  2024-09-21   High\n21        22         102         2         8   22.0  2024-09-22    Low\n22        23         103         3         7   18.0  2024-09-23   High\n23        24         104         4         6   25.0  2024-09-24    Low\n24        25         105         2        12   13.5  2024-09-25   High\n25        26         106         3         5   21.0  2024-09-26    Low\n26        27         107         1        10   19.0  2024-09-27   High\n27        28         108         5         6   27.0  2024-09-28    Low\n28        29         109         6         9   24.0  2024-09-29   High\n29        30         110         7         7   23.5  2024-09-30    Low\n30        31         101         4        13   14.5  2024-10-01   High\n31        32         102         5         6   29.0  2024-10-02    Low\n32        33         103         6         8   21.0  2024-10-03   High\n33        34         104         7         5   30.0  2024-10-04    Low\n34        35         105         4         7   15.0  2024-10-05   High\n35        36         106         5         3   25.0  2024-10-06    Low\n36        37         107         6        12   18.0  2024-10-07   High\n37        38         108         7         9   20.0  2024-10-08    Low\n38        39         109         8        10   22.0  2024-10-09   High\n39        40         110         9         6   26.0  2024-10-10    Low\n40        41         101         3         5   15.0  2024-10-11   High\n41        42         102         4         4   20.0  2024-10-12    Low\n42        43         103         5         9   19.0  2024-10-13   High\n43        44         104         6         7   28.0  2024-10-14    Low\n44        45         105         7        10   25.0  2024-10-15   High\n45        46         106         8         8   22.5  2024-10-16    Low\n46        47         107         9         6   24.0  2024-10-17   High\n47        48         108         1         3   27.0  2024-10-18    Low\n48        49         109         2        11   18.5  2024-10-19   High\n49        50         110         3        12   21.0  2024-10-20    Low\n50        51         101         1        10   15.0  2024-08-01   High\n51        52         101         1         5   25.0  2024-08-01    Low\n52        53         101         2         7   20.0  2023-09-02   High\n53        54         101         2         3   30.0  2023-09-03    Low\n54        55         105         1        12   12.0  2024-09-05   High\n55        56         106         3         8   18.0  2024-09-06    Low\n56        57         107         1         4   22.0  2024-09-07   High\n57        58         108         2         6   24.0  2024-09-08    Low\n58        59         109         3        11   19.0  2024-09-09   High\n59        60         110         4         9   17.0  2024-09-10    Low\nINFO     CommonUtilities.utilities:utilities.py:54 Actual data in the file is     sales_id  product_id  store_id  quantity  price   sale_date region\n0          1         101         1        10   15.0  2024-09-01   High\n1          2         102         1         5   25.0  2024-09-01    Low\n2          3         103         2         7   20.0  2024-09-02   High\n3          4         104         2         3   30.0  2024-09-03    Low\n4          5         105         1        12   12.0  2024-09-05   High\n5          6         106         3         8   18.0  2024-09-06    Low\n6          7         107         1         4   22.0  2024-09-07   High\n7          8         108         2         6   24.0  2024-09-08    Low\n8          9         109         3        11   19.0  2024-09-09   High\n9         10         110         4         9   17.0  2024-09-10    Low\n10        11         101         4        15   14.0  2024-09-11   High\n11        12         102         5         9   27.0  2024-09-12    Low\n12        13         103         6        10   22.0  2024-09-13   High\n13        14         104         7         8   31.0  2024-09-14    Low\n14        15         105         4        12   11.0  2024-09-15   High\n15        16         106         5         5   23.0  2024-09-16    Low\n16        17         107         6         3   26.0  2024-09-17   High\n17        18         108         7         6   28.0  2024-09-18    Low\n18        19         109         8        11   20.0  2024-09-19   High\n19        20         110         9         9   19.5  2024-09-20    Low\n20        21         101         1        14   15.5  2024-09-21   High\n21        22         102         2         8   22.0  2024-09-22    Low\n22        23         103         3         7   18.0  2024-09-23   High\n23        24         104         4         6   25.0  2024-09-24    Low\n24        25         105         2        12   13.5  2024-09-25   High\n25        26         106         3         5   21.0  2024-09-26    Low\n26        27         107         1        10   19.0  2024-09-27   High\n27        28         108         5         6   27.0  2024-09-28    Low\n28        29         109         6         9   24.0  2024-09-29   High\n29        30         110         7         7   23.5  2024-09-30    Low\n30        31         101         4        13   14.5  2024-10-01   High\n31        32         102         5         6   29.0  2024-10-02    Low\n32        33         103         6         8   21.0  2024-10-03   High\n33        34         104         7         5   30.0  2024-10-04    Low\n34        35         105         4         7   15.0  2024-10-05   High\n35        36         106         5         3   25.0  2024-10-06    Low\n36        37         107         6        12   18.0  2024-10-07   High\n37        38         108         7         9   20.0  2024-10-08    Low\n38        39         109         8        10   22.0  2024-10-09   High\n39        40         110         9         6   26.0  2024-10-10    Low\n40        41         101         3         5   15.0  2024-10-11   High\n41        42         102         4         4   20.0  2024-10-12    Low\n42        43         103         5         9   19.0  2024-10-13   High\n43        44         104         6         7   28.0  2024-10-14    Low\n44        45         105         7        10   25.0  2024-10-15   High\n45        46         106         8         8   22.5  2024-10-16    Low\n46        47         107         9         6   24.0  2024-10-17   High\n47        48         108         1         3   27.0  2024-10-18    Low\n48        49         109         2        11   18.5  2024-10-19   High\n49        50         110         3        12   21.0  2024-10-20    Low\n50        51         101         1        10   15.0  2024-08-01   High\n51        52         101         1         5   25.0  2024-08-01    Low\n52        53         101         2         7   20.0  2023-09-02   High\n53        54         101         2         3   30.0  2023-09-03    Low\n54        55         105         1        12   12.0  2024-09-05   High\n55        56         106         3         8   18.0  2024-09-06    Low\n56        57         107         1         4   22.0  2024-09-07   High\n57        58         108         2         6   24.0  2024-09-08    Low\n58        59         109         3        11   19.0  2024-09-09   High\n59        60         110         4         9   17.0  2024-09-10    Low\nINFO     TestScripts.test_data_extraction:test_data_extraction.py:31 Test case &amp;#x27;test_DE_from_sales_data_between_source_and_staging&amp;#x27; execution has completed...\n\n&#34;}], &#34;TestScripts/test_data_extraction.py::TestDataExtraction::test_DE_from_stores_data_between_source_and_staging&#34;: [{&#34;extras&#34;: [], &#34;result&#34;: &#34;Passed&#34;, &#34;testId&#34;: &#34;TestScripts/test_data_extraction.py::TestDataExtraction::test_DE_from_stores_data_between_source_and_staging&#34;, &#34;duration&#34;: &#34;481 ms&#34;, &#34;resultsTableRow&#34;: [&#34;&lt;td class=\&#34;col-result\&#34;&gt;Passed&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-testId\&#34;&gt;TestScripts/test_data_extraction.py::TestDataExtraction::test_DE_from_stores_data_between_source_and_staging&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-duration\&#34;&gt;481 ms&lt;/td&gt;&#34;, &#34;&lt;td class=\&#34;col-links\&#34;&gt;&lt;/td&gt;&#34;], &#34;log&#34;: &#34;[gw2] win32 -- Python 3.10.1 C:\\Python310\\python.exe\n\n------------------------------ Captured log setup ------------------------------\nINFO     conftest:conftest.py:22 Oracle database connectiuon is being established..\nINFO     conftest:conftest.py:25 Oracle database connectiuon has been established.\n\n------------------------------ Captured log call -------------------------------\nINFO     TestScripts.test_data_extraction:test_data_extraction.py:67 Test case execution for store data extraction has started...\nINFO     CommonUtilities.utilities:utilities.py:82 Expected data in the file is    store_id    store_name\n0         1       Walmart\n1         2        Target\n2         3      Best Buy\n3         4        Costco\n4         5    Home Depot\n5         6        Lowe&amp;#x27;s\n6         7   Apple Store\n7         8          IKEA\n8         9     Walgreens\n9        10  CVS Pharmacy\nINFO     CommonUtilities.utilities:utilities.py:84 Actual data in the file is    store_id    store_name\n0         1       Walmart\n1         2        Target\n2         3      Best Buy\n3         4        Costco\n4         5    Home Depot\n5         6        Lowe&amp;#x27;s\n6         7   Apple Store\n7         8          IKEA\n8         9     Walgreens\n9        10  CVS Pharmacy\nINFO     TestScripts.test_data_extraction:test_data_extraction.py:73 Test case execution for store data extraction has completed...\n\n---------------------------- Captured log teardown -----------------------------\nINFO     conftest:conftest.py:28 Oracle database connection has been closed.\nINFO     conftest:conftest.py:38 mysql database connection has been closed.&#34;}]}, &#34;renderCollapsed&#34;: [&#34;passed&#34;], &#34;initialSort&#34;: &#34;result&#34;, &#34;title&#34;: &#34;testResults.html&#34;}"></div>
    <script>
      (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
const { getCollapsedCategory, setCollapsedIds } = require('./storage.js')

class DataManager {
    setManager(data) {
        const collapsedCategories = [...getCollapsedCategory(data.renderCollapsed)]
        const collapsedIds = []
        const tests = Object.values(data.tests).flat().map((test, index) => {
            const collapsed = collapsedCategories.includes(test.result.toLowerCase())
            const id = `test_${index}`
            if (collapsed) {
                collapsedIds.push(id)
            }
            return {
                ...test,
                id,
                collapsed,
            }
        })
        const dataBlob = { ...data, tests }
        this.data = { ...dataBlob }
        this.renderData = { ...dataBlob }
        setCollapsedIds(collapsedIds)
    }

    get allData() {
        return { ...this.data }
    }

    resetRender() {
        this.renderData = { ...this.data }
    }

    setRender(data) {
        this.renderData.tests = [...data]
    }

    toggleCollapsedItem(id) {
        this.renderData.tests = this.renderData.tests.map((test) =>
            test.id === id ? { ...test, collapsed: !test.collapsed } : test,
        )
    }

    set allCollapsed(collapsed) {
        this.renderData = { ...this.renderData, tests: [...this.renderData.tests.map((test) => (
            { ...test, collapsed }
        ))] }
    }

    get testSubset() {
        return [...this.renderData.tests]
    }

    get environment() {
        return this.renderData.environment
    }

    get initialSort() {
        return this.data.initialSort
    }
}

module.exports = {
    manager: new DataManager(),
}

},{"./storage.js":8}],2:[function(require,module,exports){
const mediaViewer = require('./mediaviewer.js')
const templateEnvRow = document.getElementById('template_environment_row')
const templateResult = document.getElementById('template_results-table__tbody')

function htmlToElements(html) {
    const temp = document.createElement('template')
    temp.innerHTML = html
    return temp.content.childNodes
}

const find = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return elem.querySelector(selector)
}

const findAll = (selector, elem) => {
    if (!elem) {
        elem = document
    }
    return [...elem.querySelectorAll(selector)]
}

const dom = {
    getStaticRow: (key, value) => {
        const envRow = templateEnvRow.content.cloneNode(true)
        const isObj = typeof value === 'object' && value !== null
        const values = isObj ? Object.keys(value).map((k) => `${k}: ${value[k]}`) : null

        const valuesElement = htmlToElements(
            values ? `<ul>${values.map((val) => `<li>${val}</li>`).join('')}<ul>` : `<div>${value}</div>`)[0]
        const td = findAll('td', envRow)
        td[0].textContent = key
        td[1].appendChild(valuesElement)

        return envRow
    },
    getResultTBody: ({ testId, id, log, extras, resultsTableRow, tableHtml, result, collapsed }) => {
        const resultBody = templateResult.content.cloneNode(true)
        resultBody.querySelector('tbody').classList.add(result.toLowerCase())
        resultBody.querySelector('tbody').id = testId
        resultBody.querySelector('.collapsible').dataset.id = id

        resultsTableRow.forEach((html) => {
            const t = document.createElement('template')
            t.innerHTML = html
            resultBody.querySelector('.collapsible').appendChild(t.content)
        })

        if (log) {
            // Wrap lines starting with "E" with span.error to color those lines red
            const wrappedLog = log.replace(/^E.*$/gm, (match) => `<span class="error">${match}</span>`)
            resultBody.querySelector('.log').innerHTML = wrappedLog
        } else {
            resultBody.querySelector('.log').remove()
        }

        if (collapsed) {
            resultBody.querySelector('.collapsible > td')?.classList.add('collapsed')
            resultBody.querySelector('.extras-row').classList.add('hidden')
        } else {
            resultBody.querySelector('.collapsible > td')?.classList.remove('collapsed')
        }

        const media = []
        extras?.forEach(({ name, format_type, content }) => {
            if (['image', 'video'].includes(format_type)) {
                media.push({ path: content, name, format_type })
            }

            if (format_type === 'html') {
                resultBody.querySelector('.extraHTML').insertAdjacentHTML('beforeend', `<div>${content}</div>`)
            }
        })
        mediaViewer.setup(resultBody, media)

        // Add custom html from the pytest_html_results_table_html hook
        tableHtml?.forEach((item) => {
            resultBody.querySelector('td[class="extra"]').insertAdjacentHTML('beforeend', item)
        })

        return resultBody
    },
}

module.exports = {
    dom,
    htmlToElements,
    find,
    findAll,
}

},{"./mediaviewer.js":6}],3:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const storageModule = require('./storage.js')

const getFilteredSubSet = (filter) =>
    manager.allData.tests.filter(({ result }) => filter.includes(result.toLowerCase()))

const doInitFilter = () => {
    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)
}

const doFilter = (type, show) => {
    if (show) {
        storageModule.showCategory(type)
    } else {
        storageModule.hideCategory(type)
    }

    const currentFilter = storageModule.getVisible()
    const filteredSubset = getFilteredSubSet(currentFilter)
    manager.setRender(filteredSubset)

    const sortColumn = storageModule.getSort()
    doSort(sortColumn, true)
}

module.exports = {
    doFilter,
    doInitFilter,
}

},{"./datamanager.js":1,"./sort.js":7,"./storage.js":8}],4:[function(require,module,exports){
const { redraw, bindEvents, renderStatic } = require('./main.js')
const { doInitFilter } = require('./filter.js')
const { doInitSort } = require('./sort.js')
const { manager } = require('./datamanager.js')
const data = JSON.parse(document.getElementById('data-container').dataset.jsonblob)

function init() {
    manager.setManager(data)
    doInitFilter()
    doInitSort()
    renderStatic()
    redraw()
    bindEvents()
}

init()

},{"./datamanager.js":1,"./filter.js":3,"./main.js":5,"./sort.js":7}],5:[function(require,module,exports){
const { dom, find, findAll } = require('./dom.js')
const { manager } = require('./datamanager.js')
const { doSort } = require('./sort.js')
const { doFilter } = require('./filter.js')
const {
    getVisible,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    getSortDirection,
    possibleFilters,
} = require('./storage.js')

const removeChildren = (node) => {
    while (node.firstChild) {
        node.removeChild(node.firstChild)
    }
}

const renderStatic = () => {
    const renderEnvironmentTable = () => {
        const environment = manager.environment
        const rows = Object.keys(environment).map((key) => dom.getStaticRow(key, environment[key]))
        const table = document.getElementById('environment')
        removeChildren(table)
        rows.forEach((row) => table.appendChild(row))
    }
    renderEnvironmentTable()
}

const addItemToggleListener = (elem) => {
    elem.addEventListener('click', ({ target }) => {
        const id = target.parentElement.dataset.id
        manager.toggleCollapsedItem(id)

        const collapsedIds = getCollapsedIds()
        if (collapsedIds.includes(id)) {
            const updated = collapsedIds.filter((item) => item !== id)
            setCollapsedIds(updated)
        } else {
            collapsedIds.push(id)
            setCollapsedIds(collapsedIds)
        }
        redraw()
    })
}

const renderContent = (tests) => {
    const sortAttr = getSort(manager.initialSort)
    const sortAsc = JSON.parse(getSortDirection())
    const rows = tests.map(dom.getResultTBody)
    const table = document.getElementById('results-table')
    const tableHeader = document.getElementById('results-table-head')

    const newTable = document.createElement('table')
    newTable.id = 'results-table'

    // remove all sorting classes and set the relevant
    findAll('.sortable', tableHeader).forEach((elem) => elem.classList.remove('asc', 'desc'))
    tableHeader.querySelector(`.sortable[data-column-type="${sortAttr}"]`)?.classList.add(sortAsc ? 'desc' : 'asc')
    newTable.appendChild(tableHeader)

    if (!rows.length) {
        const emptyTable = document.getElementById('template_results-table__body--empty').content.cloneNode(true)
        newTable.appendChild(emptyTable)
    } else {
        rows.forEach((row) => {
            if (!!row) {
                findAll('.collapsible td:not(.col-links', row).forEach(addItemToggleListener)
                find('.logexpander', row).addEventListener('click',
                    (evt) => evt.target.parentNode.classList.toggle('expanded'),
                )
                newTable.appendChild(row)
            }
        })
    }

    table.replaceWith(newTable)
}

const renderDerived = () => {
    const currentFilter = getVisible()
    possibleFilters.forEach((result) => {
        const input = document.querySelector(`input[data-test-result="${result}"]`)
        input.checked = currentFilter.includes(result)
    })
}

const bindEvents = () => {
    const filterColumn = (evt) => {
        const { target: element } = evt
        const { testResult } = element.dataset

        doFilter(testResult, element.checked)
        const collapsedIds = getCollapsedIds()
        const updated = manager.renderData.tests.map((test) => {
            return {
                ...test,
                collapsed: collapsedIds.includes(test.id),
            }
        })
        manager.setRender(updated)
        redraw()
    }

    const header = document.getElementById('environment-header')
    header.addEventListener('click', () => {
        const table = document.getElementById('environment')
        table.classList.toggle('hidden')
        header.classList.toggle('collapsed')
    })

    findAll('input[name="filter_checkbox"]').forEach((elem) => {
        elem.addEventListener('click', filterColumn)
    })

    findAll('.sortable').forEach((elem) => {
        elem.addEventListener('click', (evt) => {
            const { target: element } = evt
            const { columnType } = element.dataset
            doSort(columnType)
            redraw()
        })
    })

    document.getElementById('show_all_details').addEventListener('click', () => {
        manager.allCollapsed = false
        setCollapsedIds([])
        redraw()
    })
    document.getElementById('hide_all_details').addEventListener('click', () => {
        manager.allCollapsed = true
        const allIds = manager.renderData.tests.map((test) => test.id)
        setCollapsedIds(allIds)
        redraw()
    })
}

const redraw = () => {
    const { testSubset } = manager

    renderContent(testSubset)
    renderDerived()
}

module.exports = {
    redraw,
    bindEvents,
    renderStatic,
}

},{"./datamanager.js":1,"./dom.js":2,"./filter.js":3,"./sort.js":7,"./storage.js":8}],6:[function(require,module,exports){
class MediaViewer {
    constructor(assets) {
        this.assets = assets
        this.index = 0
    }

    nextActive() {
        this.index = this.index === this.assets.length - 1 ? 0 : this.index + 1
        return [this.activeFile, this.index]
    }

    prevActive() {
        this.index = this.index === 0 ? this.assets.length - 1 : this.index -1
        return [this.activeFile, this.index]
    }

    get currentIndex() {
        return this.index
    }

    get activeFile() {
        return this.assets[this.index]
    }
}


const setup = (resultBody, assets) => {
    if (!assets.length) {
        resultBody.querySelector('.media').classList.add('hidden')
        return
    }

    const mediaViewer = new MediaViewer(assets)
    const container = resultBody.querySelector('.media-container')
    const leftArrow = resultBody.querySelector('.media-container__nav--left')
    const rightArrow = resultBody.querySelector('.media-container__nav--right')
    const mediaName = resultBody.querySelector('.media__name')
    const counter = resultBody.querySelector('.media__counter')
    const imageEl = resultBody.querySelector('img')
    const sourceEl = resultBody.querySelector('source')
    const videoEl = resultBody.querySelector('video')

    const setImg = (media, index) => {
        if (media?.format_type === 'image') {
            imageEl.src = media.path

            imageEl.classList.remove('hidden')
            videoEl.classList.add('hidden')
        } else if (media?.format_type === 'video') {
            sourceEl.src = media.path

            videoEl.classList.remove('hidden')
            imageEl.classList.add('hidden')
        }

        mediaName.innerText = media?.name
        counter.innerText = `${index + 1} / ${assets.length}`
    }
    setImg(mediaViewer.activeFile, mediaViewer.currentIndex)

    const moveLeft = () => {
        const [media, index] = mediaViewer.prevActive()
        setImg(media, index)
    }
    const doRight = () => {
        const [media, index] = mediaViewer.nextActive()
        setImg(media, index)
    }
    const openImg = () => {
        window.open(mediaViewer.activeFile.path, '_blank')
    }
    if (assets.length === 1) {
        container.classList.add('media-container--fullscreen')
    } else {
        leftArrow.addEventListener('click', moveLeft)
        rightArrow.addEventListener('click', doRight)
    }
    imageEl.addEventListener('click', openImg)
}

module.exports = {
    setup,
}

},{}],7:[function(require,module,exports){
const { manager } = require('./datamanager.js')
const storageModule = require('./storage.js')

const genericSort = (list, key, ascending, customOrder) => {
    let sorted
    if (customOrder) {
        sorted = list.sort((a, b) => {
            const aValue = a.result.toLowerCase()
            const bValue = b.result.toLowerCase()

            const aIndex = customOrder.findIndex((item) => item.toLowerCase() === aValue)
            const bIndex = customOrder.findIndex((item) => item.toLowerCase() === bValue)

            // Compare the indices to determine the sort order
            return aIndex - bIndex
        })
    } else {
        sorted = list.sort((a, b) => a[key] === b[key] ? 0 : a[key] > b[key] ? 1 : -1)
    }

    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const durationSort = (list, ascending) => {
    const parseDuration = (duration) => {
        if (duration.includes(':')) {
            // If it's in the format "HH:mm:ss"
            const [hours, minutes, seconds] = duration.split(':').map(Number)
            return (hours * 3600 + minutes * 60 + seconds) * 1000
        } else {
            // If it's in the format "nnn ms"
            return parseInt(duration)
        }
    }
    const sorted = list.sort((a, b) => parseDuration(a['duration']) - parseDuration(b['duration']))
    if (ascending) {
        sorted.reverse()
    }
    return sorted
}

const doInitSort = () => {
    const type = storageModule.getSort(manager.initialSort)
    const ascending = storageModule.getSortDirection()
    const list = manager.testSubset
    const initialOrder = ['Error', 'Failed', 'Rerun', 'XFailed', 'XPassed', 'Skipped', 'Passed']

    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    if (type?.toLowerCase() === 'original') {
        manager.setRender(list)
    } else {
        let sortedList
        switch (type) {
        case 'duration':
            sortedList = durationSort(list, ascending)
            break
        case 'result':
            sortedList = genericSort(list, type, ascending, initialOrder)
            break
        default:
            sortedList = genericSort(list, type, ascending)
            break
        }
        manager.setRender(sortedList)
    }
}

const doSort = (type, skipDirection) => {
    const newSortType = storageModule.getSort(manager.initialSort) !== type
    const currentAsc = storageModule.getSortDirection()
    let ascending
    if (skipDirection) {
        ascending = currentAsc
    } else {
        ascending = newSortType ? false : !currentAsc
    }
    storageModule.setSort(type)
    storageModule.setSortDirection(ascending)

    const list = manager.testSubset
    const sortedList = type === 'duration' ? durationSort(list, ascending) : genericSort(list, type, ascending)
    manager.setRender(sortedList)
}

module.exports = {
    doInitSort,
    doSort,
}

},{"./datamanager.js":1,"./storage.js":8}],8:[function(require,module,exports){
const possibleFilters = [
    'passed',
    'skipped',
    'failed',
    'error',
    'xfailed',
    'xpassed',
    'rerun',
]

const getVisible = () => {
    const url = new URL(window.location.href)
    const settings = new URLSearchParams(url.search).get('visible')
    const lower = (item) => {
        const lowerItem = item.toLowerCase()
        if (possibleFilters.includes(lowerItem)) {
            return lowerItem
        }
        return null
    }
    return settings === null ?
        possibleFilters :
        [...new Set(settings?.split(',').map(lower).filter((item) => item))]
}

const hideCategory = (categoryToHide) => {
    const url = new URL(window.location.href)
    const visibleParams = new URLSearchParams(url.search).get('visible')
    const currentVisible = visibleParams ? visibleParams.split(',') : [...possibleFilters]
    const settings = [...new Set(currentVisible)].filter((f) => f !== categoryToHide).join(',')

    url.searchParams.set('visible', settings)
    window.history.pushState({}, null, unescape(url.href))
}

const showCategory = (categoryToShow) => {
    if (typeof window === 'undefined') {
        return
    }
    const url = new URL(window.location.href)
    const currentVisible = new URLSearchParams(url.search).get('visible')?.split(',').filter(Boolean) ||
        [...possibleFilters]
    const settings = [...new Set([categoryToShow, ...currentVisible])]
    const noFilter = possibleFilters.length === settings.length || !settings.length

    noFilter ? url.searchParams.delete('visible') : url.searchParams.set('visible', settings.join(','))
    window.history.pushState({}, null, unescape(url.href))
}

const getSort = (initialSort) => {
    const url = new URL(window.location.href)
    let sort = new URLSearchParams(url.search).get('sort')
    if (!sort) {
        sort = initialSort || 'result'
    }
    return sort
}

const setSort = (type) => {
    const url = new URL(window.location.href)
    url.searchParams.set('sort', type)
    window.history.pushState({}, null, unescape(url.href))
}

const getCollapsedCategory = (renderCollapsed) => {
    let categories
    if (typeof window !== 'undefined') {
        const url = new URL(window.location.href)
        const collapsedItems = new URLSearchParams(url.search).get('collapsed')
        switch (true) {
        case !renderCollapsed && collapsedItems === null:
            categories = ['passed']
            break
        case collapsedItems?.length === 0 || /^["']{2}$/.test(collapsedItems):
            categories = []
            break
        case /^all$/.test(collapsedItems) || collapsedItems === null && /^all$/.test(renderCollapsed):
            categories = [...possibleFilters]
            break
        default:
            categories = collapsedItems?.split(',').map((item) => item.toLowerCase()) || renderCollapsed
            break
        }
    } else {
        categories = []
    }
    return categories
}

const getSortDirection = () => JSON.parse(sessionStorage.getItem('sortAsc')) || false
const setSortDirection = (ascending) => sessionStorage.setItem('sortAsc', ascending)

const getCollapsedIds = () => JSON.parse(sessionStorage.getItem('collapsedIds')) || []
const setCollapsedIds = (list) => sessionStorage.setItem('collapsedIds', JSON.stringify(list))

module.exports = {
    getVisible,
    hideCategory,
    showCategory,
    getCollapsedIds,
    setCollapsedIds,
    getSort,
    setSort,
    getSortDirection,
    setSortDirection,
    getCollapsedCategory,
    possibleFilters,
}

},{}]},{},[4]);
    </script>
  </footer>
</html>